<!DOCTYPE html>
<html>
<head>
  <title>Wing Check-in</title>
  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
</head>
<body>
  <select id="wingSelect">
    <option value="wing1">Wing 1</option>
    <option value="wing2">Wing 2</option>
    <option value="wing3">Wing 3</option>
  </select>
  <div id="qrReader" style="width: 300px"></div>

  <script>
    const qrScanner = new Html5Qrcode("qrReader");
    const wingSelect = document.getElementById('wingSelect');

    qrScanner.start(
      { facingMode: "environment" },
      { fps: 10, qrbox: 250 },
      async (qrCode) => {
        qrScanner.stop();
        
        const response = await fetch('https://script.google.com/macros/s/AKfycbzViYJSyJemchSq4Cr0dSP4uEN6MI4oZgkakqB9p1cVdTi3_5aEt8dkOKxtgloUUZjW/exec', {
          method: 'POST',
          body: JSON.stringify({
            type: 'visit',
            serial: qrCode,
            wing: wingSelect.value
          })
        });
        
        const result = await response.json();
        if (result.status === 'success') {
          alert('Check-in successful!');
          window.location.reload();
        }
      },
      (error) => console.error(error)
    ).catch(err => console.error(err));
  </script>
</body>
</html>
