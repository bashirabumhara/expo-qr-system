<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>
</head>
<body>
    <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø±</h2>
    <form id="visitorForm">
        <label>Ø§Ù„Ø§ÙƒÙ…:</label>
        <input type="text" id="name" required><br><br>

        <label>Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©:</label>
        <input type="text" id="university" required><br><br>

        <label>Ø§Ù„ÙƒÙ„ÙŠØ©:</label>
        <input type="text" id="college" required><br><br>

        <label>ÙƒÙˆØ¯ QR:</label>
        <input type="text" id="qrCode" required>
        <button type="button" onclick="startScanner()">ðŸ“· Ù…Ø³Ø­ QR</button>
        <div id="reader" style="width: 300px;"></div><br>

        <button type="submit">ØªØ³Ø¬ÙŠÙ„</button>
    </form>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbw9PmDQlwoamPv8h0CsT_0hSRZoMihY6Ft6oGShmL9SyvvUUFs72wSJlmiEXH60nFJf/exec";  // Replace with your actual script URL

        function startScanner() {
            document.getElementById("reader").innerHTML = "";
            let scanner = new Html5Qrcode("reader");
            scanner.start(
                { facingMode: "environment" },
                { fps: 10, qrbox: 250 },
                (decodedText) => {
                    document.getElementById("qrCode").value = decodedText;
                    scanner.stop();
                },
                (errorMessage) => {}
            );
        }

        document.getElementById("visitorForm").addEventListener("submit", function(e) {
            e.preventDefault();
            
            let data = {
                type: "register",
                name: document.getElementById("name").value,
                university: document.getElementById("university").value,
                college: document.getElementById("college").value,
                qrCode: document.getElementById("qrCode").value
            };

            fetch(scriptURL, {
                method: "POST",
                body: JSON.stringify(data),
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.text())
            .then(result => {
                alert(result);
                console.log(result);
            })
            .catch(error => {
                console.error("Error:", error);
                alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø£Ùˆ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§.");
            });
        });
    </script>
</body>
</html>
